{"version":3,"sources":["src/functree.js"],"names":["DEFAULT_CONFIG","FuncTree","root","config","x0","y0","nodes","getNodes","Object","assign","tree","d3","layout","size","diameter","id","node","initTree","values","value","cols","children","depth","displayNodesLowerThan","_children","elementId","width","height","svg","select","insert","attr","viewBoxWidth","viewBoxHeight","buffer","append","groupIds","i","call","behavior","zoom","translate","scaleExtent","on","event","scale","source","links","max","map","x","getClassMax","maxFunc","Array","from","v","candidates","filter","maxValue","maxSumOfValues","sum","maxMaxOfValues","_updateRings","_updateLinks","_updateNodes","_updateBars","_updateRounds","_updateLabels","y","$","tooltip","container","placement","ring","selectAll","data","range","enter","d","transition","duration","exit","remove","diagonal","radial","projection","Math","PI","straight","cos","sin","target","link","o","vector","_highlightLinks","entry","name","_collapseChildren","update","style","chart","bar","n","color","class","length","p","parentNode","__data__","maxHight","subSum","slice","normalize","circle","displayBars","r_","label","displayRounds","text","replace","split","drag","sourceEvent","stopPropagation","push","parent"],"mappings":"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","file":"functree.js","sourcesContent":["'use strict';\n\nconst DEFAULT_CONFIG = {\n    'elementId': 'functree',\n    'width': 1800,\n    'height': 1800,\n    'viewBoxWidth': 1200,\n    'viewBoxHeight': 1200,\n    'diameter': 800,\n    'duration': 1000,\n    'normalize': true,\n    'displayRounds': true,\n    'displayBars': false,\n    'displayNodesLowerThan': 5,\n    'color': {\n        'class': [\n            '#5f5f5f',\n            '#2F57D0',\n            '#5381DF',\n            '#41B360',\n            '#E0462F',\n            '#DA9F33'\n        ]\n    }\n}\n\nconst FuncTree = class {\n    constructor(root, config={}) {\n        this.root = root;\n        this.root.x0 = 0;\n        this.root.y0 = 0;\n        this.nodes = this.getNodes();\n        this.config = Object.assign(DEFAULT_CONFIG, config);\n        this.tree = d3.layout.tree()\n            .size([360, this.config.diameter / 2]);\n        let id = 0;\n        for (const node of this.nodes) {\n            node.id = id++;\n        }\n        this.initTree();\n    }\n\n    configure(config=DEFAULT_CONFIG) {\n        this.config = Object.assign(this.config, config);\n        return this;\n    }\n\n    initTree() {\n        for (const node of this.nodes) {\n            node.values = [];\n            node.value = 0;\n            node.cols = [];\n            if (node.children && node.depth >= this.config.displayNodesLowerThan - 1) {\n                node._children = node.children;\n                node.children = null;\n            }\n            if (node._children && node.depth < this.config.displayNodesLowerThan - 1) {\n                node.children = node._children;\n                node._children = null;\n            }\n        }\n        return this;\n    }\n\n    create(elementId=this.config.elementId, width=this.config.width, height=this.config.height) {\n        const svg = d3.select('#' + elementId)\n            .insert('svg', ':first-child')\n            .attr('xmlns', 'http://www.w3.org/2000/svg')\n            .attr('version', '1.1')\n            .attr('width', width)\n            .attr('height', height)\n            .attr('viewBox', '0 0 ' + this.config.viewBoxWidth + ' ' + this.config.viewBoxHeight);\n        const buffer = svg.append('g')\n            .attr('id', 'buffer')\n            .attr('transform', 'translate(' + this.config.viewBoxWidth / 2 + ',' + this.config.viewBoxHeight / 2 + '),scale(1)');\n        const groupIds = [\n            'rings',\n            'links',\n            'charts',\n            'rounds',\n            'labels',\n            'nodes'\n        ];\n        for (const i of groupIds) {\n            buffer.append('g').attr('id', i);\n        }\n        svg.call(d3.behavior.zoom()\n            .translate([this.config.viewBoxWidth / 2, this.config.viewBoxHeight / 2])\n            .scaleExtent([0.5, 10])\n            .on('zoom', () => {\n                buffer.attr({\n                    'transform': 'translate(' + d3.event.translate + '),scale(' + d3.event.scale + ')'\n                });\n            })\n        );\n        return this;\n    }\n\n    update(source=this.root) {\n        const nodes = this.tree.nodes(this.root);\n        const links = this.tree.links(nodes);\n        const depth = d3.max(\n            nodes.map((x) => {\n                return x.depth;\n            })\n        );\n\n        const getClassMax = (nodes, maxFunc) => {\n            return Array.from(new Array(depth + 1))\n                .map((v, i) => {\n                    const candidates = nodes\n                        .filter((x) => {\n                            return x.depth === i;\n                        })\n                        .map(maxFunc);\n                    return d3.max(candidates);\n                });\n        };\n        const maxValue = getClassMax(nodes, (x) => {\n            return x.value;\n        });\n        const maxSumOfValues = getClassMax(nodes, (x) => {\n            return d3.sum(x.values);\n        });\n        const maxMaxOfValues = getClassMax(nodes, (x) => {\n            return d3.max(x.values);\n        });\n\n        this._updateRings(depth);\n        this._updateLinks(links, source);\n        this._updateNodes(nodes, source);\n        this._updateBars(nodes, source, depth, maxSumOfValues, maxMaxOfValues);\n        this._updateRounds(nodes, source, depth, maxValue);\n        this._updateLabels(nodes, source, maxValue, maxSumOfValues);\n\n        for (const node of nodes) {\n            node.x0 = node.x;\n            node.y0 = node.y;\n        }\n\n        // Enable showing tooltip by Bootstrap\n        $('[data-toggle=\"tooltip\"]').tooltip({\n            container: 'body',\n            placement: 'top'\n        });\n    }\n\n    _updateRings(depth) {\n        const ring = d3.select('#rings')\n            .selectAll('circle')\n            .data(d3.range(1, depth, 2));\n        ring.enter()\n            .append('circle')\n            .attr('fill', 'none')\n            .attr('r', (d) => {\n                return (this.config.diameter / 2) / depth * (d + 0.5) || 0;\n            })\n            .attr('stroke', '#f8f8f8')\n            .attr('stroke-width', 0);\n        ring\n            .transition()\n            .duration(this.config.duration)\n            .attr('r', (d) => {\n                return (this.config.diameter / 2) / depth * (d + 0.5) || 0;\n            })\n            .attr('stroke-width', (this.config.diameter / 2) / depth || 0);\n        ring.exit()\n            .transition()\n            .duration(this.config.duration)\n            .attr('stroke-width', 0)\n            .remove();\n    }\n\n    _updateLinks(links, source) {\n        const diagonal = d3.svg.diagonal.radial()\n            .projection((d) => {\n                return [d.y, d.x / 180 * Math.PI];\n            });\n        const straight = (d) => {\n            const x = (d) => {\n                return d.y * Math.cos((d.x - 90) / 180 * Math.PI);\n            };\n            const y = (d) => {\n                return d.y * Math.sin((d.x - 90) / 180 * Math.PI);\n            };\n            return 'M' + x(d.source) + ',' + y(d.source) + 'L' + x(d.target) + ',' + y(d.target);\n        };\n        const link = d3.select('#links')\n            .selectAll('path')\n            .data(links, (d) => {\n                return d.target.id;\n            });\n        link.enter()\n            .append('path')\n            .attr('fill', 'none')\n            .attr('stroke', '#999')\n            .attr('stroke-width', 0.5)\n            .attr('stroke-dasharray', (d) => {\n                if (d.source.depth === 0) {\n                    return '3,3';\n                }\n            })\n            .attr('d', (d) => {\n                const o = {\n                    'x': source.x0,\n                    'y': source.y0\n                };\n                const vector = {\n                    'source': o,\n                    'target': o\n                };\n                if (d.source.depth === 0) {\n                    return straight(vector);\n                } else {\n                    return diagonal(vector);\n                }\n            })\n            .on('mouseover', (d) => {\n                this._highlightLinks(d.target);\n            })\n            .on('mouseout', () => {\n                d3.select('#links')\n                    .selectAll('path')\n                    .attr('style', null);\n            });\n        link\n            .transition()\n            .duration(this.config.duration)\n            .attr('d', (d) => {\n                if (d.source.depth === 0) {\n                    return straight(d);\n                } else {\n                    return diagonal(d);\n                }\n            });\n        link.exit()\n            .transition()\n            .duration(this.config.duration)\n            .attr('d', (d) => {\n                const o = {\n                    'x': source.x,\n                    'y': source.y\n                };\n                const vector = {\n                    'source': o,\n                    'target': o\n                };\n                if (d.source.depth === 0) {\n                    return straight(vector);\n                } else {\n                    return diagonal(vector);\n                }\n            })\n            .remove();\n    }\n\n    _updateNodes(nodes, source) {\n        const node = d3.select('#nodes')\n            .selectAll('circle')\n            .data(nodes, (d) => {\n                return d.id;\n            });\n        node.enter()\n            .append('circle')\n            .attr('transform', () => {\n                return 'rotate(' + (source.x0 - 90) + '),translate(' + source.y0 + ')';\n            })\n            .attr('r', 1)\n            .attr('fill', (d) => {\n                return d._children ? '#ddd' : '#fff';\n            })\n            .attr('stroke', '#999')\n            .attr('stroke-width', 0.5)\n            .attr('cursor', 'pointer')\n            .attr('data-toggle', 'tooltip')\n            .attr('data-original-title', (d) => {\n                return '[' + d.entry + '] ' + d.name;\n            })\n            .on('click', (d) => {\n                this._collapseChildren(d);\n                this.update(d);\n            })\n            .on('mouseover', (d) => {\n                d3.select(d3.event.target)\n                    .style('r', 10)\n                    .style('fill', '#000')\n                    .style('opacity', 0.5);\n                this._highlightLinks(d);\n            })\n            .on('mouseout', () => {\n                d3.select(d3.event.target)\n                    .attr('style', null);\n                d3.select('#links')\n                    .selectAll('path')\n                    .attr('style', null);\n            });\n        node\n            .transition()\n            .duration(this.config.duration)\n            .attr('fill', (d) => {\n                return d._children ? '#ddd' : '#fff';\n            })\n            .attr('transform', (d) => {\n                return 'rotate(' + (d.x - 90) + '),translate(' + d.y + ')';\n            });\n        node.exit()\n            .transition()\n            .duration(this.config.duration)\n            .attr('r', 0)\n            .attr('transform', () => {\n                return 'rotate(' + (source.x - 90) + '),translate(' + source.y + ')';\n            })\n            .remove();\n    }\n\n    _updateBars(nodes, source, depth, maxSumOfValues, maxMaxOfValues) {\n        const config = this.config;\n        const chart = d3.select('#charts')\n            .selectAll('g')\n            .data(nodes, (d) => {\n                return d.id;\n            });\n        chart.enter()\n            .append('g')\n            .attr('transform', 'rotate(' + (source.x0 - 90) + '),translate(' + source.y0 + '),rotate(-90)')\n            .attr('data-toggle', 'tooltip')\n            .attr('data-original-title', function(d) {\n                return '[' + d.entry + '] ' + d.name;\n            })\n            .on('click', (d) => {\n                this._collapseChildren(d);\n                this.update(d);\n            })\n            .on('mouseover', (d) => {\n                this._highlightLinks(d);\n            })\n            .on('mouseout', () => {\n                d3.select('#links')\n                    .selectAll('path')\n                    .attr('style', null);\n            });\n        chart\n            .transition()\n            .duration(this.config.duration)\n            .attr('transform', (d) => {\n                return 'rotate(' + (d.x - 90) + '),translate(' + d.y + '),rotate(-90)';\n            });\n        chart.exit()\n            .transition()\n            .duration(this.config.duration)\n            .attr('transform', 'rotate(' + (source.x - 90) + '),translate(' + source.y + '),rotate(-90)')\n            .remove();\n\n        const bar = chart\n            .selectAll('rect')\n            .data((d) => {\n                return d.values;\n            });\n        bar.enter()\n            .append('rect')\n            .attr('x', -1)\n            .attr('y', 0)\n            .attr('width', 2)\n            .attr('height', 0)\n            .attr('fill', function(d, i) {\n                const n = i % config.color.class.length;\n                return config.color.class[n];\n            })\n            .on('mouseover', (d) => {\n                d3.select(d3.event.target)\n                    .style('fill', '#000')\n                    .style('opacity', 0.5);\n                this._highlightLinks(d);\n            })\n            .on('mouseout', () => {\n                d3.select(d3.event.target)\n                    .attr('style', null);\n                d3.select('#charts')\n                    .selectAll('rect')\n                    .attr('style', null);\n            });\n        bar\n            .transition()\n            .duration(this.config.duration)\n            .attr('y', function(d, i) {\n                const p = this.parentNode.__data__;\n                const maxHight = config.diameter / 2 / depth * 0.8;\n                const subSum = d3.sum(p.values.slice(0, i));\n                if (config.normalize) {\n                    return subSum / maxSumOfValues[p.depth] * maxHight || 0;\n                } else {\n                    return subSum;\n                }\n            })\n            .attr('height', function(d) {\n                const p = this.parentNode.__data__;\n                const maxHight = config.diameter / 2 / depth * 0.8;\n                if (config.normalize) {\n                    return d / maxSumOfValues[p.depth] * maxHight || 0;\n                } else {\n                    return d;\n                }\n            });\n        bar.exit()\n            .transition()\n            .duration(this.config.duration)\n            .attr('y', 0)\n            .attr('height', 0)\n            .remove();\n    }\n\n    _updateRounds(nodes, source, depth, max) {\n        const circle = d3.select('#rounds')\n            .selectAll('circle')\n            .data(nodes, (d) => {\n                return d.id;\n            });\n        circle.enter()\n            .append('circle')\n            .attr('transform', () => {\n                return 'rotate(' + (source.x0 - 90) + '),translate(' + source.y0 + ')';\n            })\n            .attr('r', 0)\n            .attr('fill', (d) => {\n                if (this.config.displayBars) {\n                    return '#fff';\n                } else {\n                    const n = d.depth % this.config.color.class.length;\n                    return this.config.color.class[n];\n                }\n            })\n            .attr('stroke', () => {\n                return this.config.displayBars ? '#333' : '#fff';\n            })\n            .attr('stroke-width', 0.5)\n            .attr('opacity', 0.75)\n            .attr('data-toggle', 'tooltip')\n            .attr('data-original-title', (d) => {\n                return '[' + d.entry + '] ' + d.name;\n            })\n            .on('click', (d) => {\n                this._collapseChildren(d);\n                this.update(d);\n            })\n            .on('mouseover', (d) => {\n                d3.select(d3.event.target)\n                    .style('fill', '#000')\n                    .style('opacity', 0.5);\n                this._highlightLinks(d);\n            })\n            .on('mouseout', () => {\n                d3.select(d3.event.target)\n                    .attr('style', null);\n                d3.select('#links')\n                    .selectAll('path')\n                    .attr('style', null);\n            });\n        circle\n            .transition()\n            .duration(this.config.duration)\n            .attr('r', (d) => {\n                const r_ = 25;\n                if (this.config.normalize) {\n                    return d.value / max[d.depth] * r_ || 0;\n                } else {\n                    return d.value;\n                }\n            })\n            .attr('transform', (d) => {\n                return 'rotate(' + (d.x - 90) + '),translate(' + d.y + ')';\n            });\n        circle.exit()\n            .transition()\n            .duration(this.config.duration)\n            .attr('r', 0)\n            .attr('transform', () => {\n                return 'rotate(' + (source.x - 90) + '),translate(' + source.y + ')';\n            })\n            .remove();\n    }\n\n    _updateLabels(nodes, source, maxValue, maxSumOfValues) {\n        const data = nodes.filter((d) => {\n            return d.depth < 2;\n        });\n        const label = d3.select('#labels')\n            .selectAll('g')\n            .data(data, (d) => {\n                return d.id;\n            })\n        label.enter()\n            .append('g')\n            .attr('transform', (d) => {\n                return 'rotate(' + (d.x - 90) + '),translate(' + d.y + '),rotate(' + (90 - d.x) + ')';\n            })\n            .append('text')\n            .attr('text-anchor', 'middle')\n            .attr('font-family', 'arial, sans-serif')\n            .attr('font-size', (d) => {\n                const value = this.config.displayRounds ?\n                    d.value :\n                    d3.sum(d.values);\n                const max = this.config.displayRounds ?\n                    maxValue[d.depth] :\n                    maxSumOfValues[d.depth];\n                const size = (value / max * 10 || 0) + 10;\n                return size;\n            })\n            .attr('y', (d) => {\n                const value = this.config.displayRounds ?\n                    d.value :\n                    d3.sum(d.values);\n                const max = this.config.displayRounds ?\n                    maxValue[d.depth] :\n                    maxSumOfValues[d.depth];\n                const size = (value / max * 10 + 5 || 0) + 10;\n                return - size / 2;\n            })\n            .attr('fill', '#555')\n            .text((d) => {\n                return d.name\n                    .replace(/ \\[.*\\]/, '')\n                    .split(', ')[0];\n            });\n        label\n            .transition()\n            .duration(this.config.duration)\n            .attr('transform', (d) => {\n                return 'rotate(' + (d.x - 90) + '),translate(' + d.y + '),rotate(' + (90 - d.x) + ')';\n            });\n        label.exit()\n            .transition()\n            .duration(this.config.duration)\n            .remove();\n        label.selectAll('text')\n            .call(d3.behavior.drag()\n                .on('dragstart', () => {\n        \t    \td3.event.sourceEvent.stopPropagation();\n        \t    })\n                .on('drag', function(d) {\n                    d3.select(this)\n                        .attr('y', 0)\n                        .attr('transform', 'translate(' + d3.event.x + ',' + d3.event.y + ')');\n                })\n            );\n    }\n\n\n    getNodes(node=this.root, nodes=[], depth=0) {\n        node.depth = depth;\n        nodes.push(node);\n        for (const node of (node.children || node._children || [])) {\n            this.getNodes(node, nodes, depth + 1);\n        }\n        return nodes;\n    }\n\n    _collapseChildren(node) {\n        if (node.children) {\n            node._children = node.children;\n            node.children = null;\n        } else if (node._children) {\n            node.children = node._children;\n            node._children = null;\n        }\n    }\n\n    _highlightLinks(node) {\n        d3.selectAll('path')\n            .filter((d) => {\n                if (d.target.id === node.id) {\n                    return true;\n                }\n            })\n            .style('stroke', (d) => {\n                const n = d.target.depth % this.config.color.class.length;\n                return this.config.color.class[n];\n            })\n            .style('stroke-width', 1.5);\n        if (node.parent) {\n            this._highlightLinks(node.parent);\n        }\n    }\n}\n"]}